# MCP Orch 설치 가이드

## 목차
1. [요구사항](#요구사항)
2. [uv를 사용한 설치](#uv를-사용한-설치)
3. [pip를 사용한 설치 (대안)](#pip를-사용한-설치-대안)
4. [개발 환경 설정](#개발-환경-설정)
5. [설정 파일 구성](#설정-파일-구성)
6. [서버 실행](#서버-실행)
7. [문제 해결](#문제-해결)

## 요구사항

- Python 3.11 이상
- uv (권장) 또는 pip
- Git (소스에서 설치 시)

## uv를 사용한 설치

### 1. uv 설치

uv가 설치되어 있지 않다면 먼저 설치합니다:

```bash
# macOS/Linux
curl -LsSf https://astral.sh/uv/install.sh | sh

# Windows (PowerShell)
powershell -c "irm https://astral.sh/uv/install.ps1 | iex"

# 또는 pip로 설치
pip install uv
```

### 2. MCP Orch 설치

#### 옵션 1: PyPI에서 설치 (출시 후)
```bash
uv pip install mcp-orch
```

#### 옵션 2: GitHub에서 직접 설치
```bash
uv pip install git+https://github.com/your-org/mcp-orch.git
```

#### 옵션 3: 소스에서 설치 (개발용)
```bash
# 저장소 클론
git clone https://github.com/your-org/mcp-orch.git
cd mcp-orch

# 가상환경 생성 및 활성화
uv venv
source .venv/bin/activate  # Linux/macOS
# 또는
.venv\Scripts\activate  # Windows

# 개발 모드로 설치
uv pip install -e ".[dev]"
```

### 3. LLM 지원 설치 (선택사항)

LLM 기능을 사용하려면 추가 의존성을 설치합니다:

```bash
# Azure AI Foundry / AWS Bedrock 지원
uv pip install "mcp-orch[llm]"
```

## pip를 사용한 설치 (대안)

uv를 사용할 수 없는 경우 pip를 사용할 수 있습니다:

```bash
# 기본 설치
pip install mcp-orch

# 개발 환경
pip install -e ".[dev]"

# LLM 지원 포함
pip install "mcp-orch[llm]"
```

## 개발 환경 설정

### 1. 프로젝트 설정

```bash
# 저장소 클론
git clone https://github.com/your-org/mcp-orch.git
cd mcp-orch

# uv로 가상환경 생성
uv venv

# 가상환경 활성화
source .venv/bin/activate  # Linux/macOS
.venv\Scripts\activate      # Windows

# 개발 의존성 설치
uv pip install -e ".[dev,llm]"
```

### 2. pre-commit 설정

코드 품질을 유지하기 위해 pre-commit을 설정합니다:

```bash
# pre-commit 훅 설치
pre-commit install

# 수동으로 실행
pre-commit run --all-files
```

### 3. 테스트 실행

```bash
# 단위 테스트
pytest

# 커버리지 포함
pytest --cov=mcp_orch

# 특정 테스트만
pytest tests/test_proxy.py -v
```

## 설정 파일 구성

### 1. MCP 서버 설정 파일 생성

```bash
# 샘플 설정 파일 생성
mcp-orch init

# 또는 직접 생성
cat > mcp-config.json << EOF
{
  "mcpServers": {
    "github-server": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-github"],
      "env": {
        "GITHUB_TOKEN": "your-github-token"
      }
    },
    "notion-server": {
      "command": "node",
      "args": ["/path/to/notion-server"],
      "env": {
        "NOTION_API_KEY": "your-notion-key"
      }
    }
  }
}
EOF
```

### 2. 환경 변수 설정

`.env` 파일을 생성하여 환경 변수를 설정합니다:

```bash
# .env 파일
PROXY_PORT=3000
LOG_LEVEL=INFO
API_KEY=your-api-key
JWT_SECRET=your-jwt-secret

# LLM 설정 (선택사항)
AZURE_AI_ENDPOINT=https://your-endpoint.azure.com
AZURE_AI_API_KEY=your-azure-key
```

## 서버 실행

### 1. 기본 실행

```bash
# 프록시 모드로 실행
mcp-orch serve

# 특정 포트로 실행
mcp-orch serve --port 8080

# 디버그 모드
mcp-orch serve --log-level DEBUG

# 자동 리로드 (개발용)
mcp-orch serve --reload
```

### 2. 배치 모드 실행

```bash
# 병렬화 모드로 실행
mcp-orch serve --mode batch
```

### 3. 도구 및 서버 확인

```bash
# 설정된 서버 목록 확인
mcp-orch list-servers

# 사용 가능한 도구 목록 확인
mcp-orch list-tools
```

## 문제 해결

### 1. uv 설치 문제

```bash
# uv가 PATH에 없는 경우
export PATH="$HOME/.cargo/bin:$PATH"

# 권한 문제
chmod +x ~/.cargo/bin/uv
```

### 2. Python 버전 문제

```bash
# Python 3.11+ 확인
python --version

# pyenv로 Python 3.11 설치
pyenv install 3.11.7
pyenv local 3.11.7
```

### 3. 의존성 충돌

```bash
# 가상환경 재생성
rm -rf .venv
uv venv
source .venv/bin/activate
uv pip install -e ".[dev]"
```

### 4. MCP 서버 연결 문제

```bash
# 로그 레벨 높이기
mcp-orch serve --log-level DEBUG

# 특정 서버만 테스트
mcp-orch list-servers --test github-server
```

## 다음 단계

1. [빠른 시작 가이드](../README.md#빠른-시작) 참조
2. [API 문서](../README.md#api-문서) 확인
3. [설정 옵션](../README.md#설정) 검토

## 지원

문제가 발생하면:
- [GitHub Issues](https://github.com/your-org/mcp-orch/issues)에 보고
- [문서](https://github.com/your-org/mcp-orch/docs) 참조
- 커뮤니티 포럼 참여
